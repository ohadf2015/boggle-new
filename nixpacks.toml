[phases.setup]
nixPkgs = ['nodejs_20']
aptPkgs = []

[phases.install]
dependsOn = ['setup']
cmds = [
    'cd fe-next',
    'npm ci --prefer-offline --no-audit --no-fund --loglevel=error'
]
cacheDirectories = ['fe-next/node_modules', 'fe-next/.next/cache']

[phases.build]
dependsOn = ['install']
cmds = [
    'cd fe-next',
    'npm run build --loglevel=error'
]

[start]
cmd = 'cd fe-next && npm start'

[variables]
NODE_ENV = 'production'
NPM_CONFIG_LOGLEVEL = 'error'
